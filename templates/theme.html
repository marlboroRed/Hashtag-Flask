<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>í…Œë§ˆë³„ í•´ì‹œíƒœê·¸ ìƒì„±ê¸°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/static/style.css">
</head>

<body>
  <div class="outer-wrapper">
    <div class="container">

      {% if not hashtags %}
      <form method="POST">
        <div class="theme-box">
          {% for theme in themes %}
          <label>
            <input type="checkbox" name="themes" value="{{ theme }}" {% if theme in selected_themes %}checked{% endif %}>
            {{ theme }}
          </label>
          {% endfor %}
        </div>
        <button type="submit">í•´ì‹œíƒœê·¸ ì¶”ì²œ</button>

        <!-- âœ… ì•± ë‚´ë¶€ì—ì„œë§Œ ë³´ì´ë„ë¡ ë²„íŠ¼ì„ JSì—ì„œ ì‚½ì… -->
        <div id="reward-container"></div>
      </form>
      {% endif %}

      {% if hashtags %}
      <div class="result">
        <h3>ì¶”ì²œ í•´ì‹œíƒœê·¸</h3>
        <div id="hashtag-list">
          {% for tag in hashtags.split() %}
            <label class="hashtag-item">
              <input type="checkbox" class="tag-check" value="{{ tag }}">
              {{ tag }}
            </label>
          {% endfor %}
        </div>
        <div class="copy-buttons">
          <button onclick="copySelected()">ì„ íƒëœ í•­ëª© ë³µì‚¬</button>
          <button onclick="copyAll()">ì „ì²´ ë³µì‚¬</button>
        </div>
      </div>
      {% endif %}

      {% if message %}
      <p class="error">{{ message }}</p>
      {% endif %}

    </div>
  </div>

  <!-- í™ˆìœ¼ë¡œ ì´ë™ -->
  <a href="/" class="home-button" title="ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°">
    <img src="/static/home-icon.png" alt="í™ˆìœ¼ë¡œ" class="home-icon">
  </a>

  <!-- âœ… í•´ì‹œíƒœê·¸ ë³µì‚¬ í•¨ìˆ˜ -->
  <script>
    function copySelected() {
      const checks = document.querySelectorAll(".tag-check:checked");
      const tags = Array.from(checks).map(el => el.value).join(" ");
      if (tags) {
        navigator.clipboard.writeText(tags).then(() => alert("ì„ íƒëœ í•´ì‹œíƒœê·¸ ë³µì‚¬ ì™„ë£Œ!"));
      } else {
        alert("ì„ íƒëœ í•´ì‹œíƒœê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.");
      }
    }

    function copyAll() {
      const allTags = Array.from(document.querySelectorAll(".tag-check")).map(el => el.value).join(" ");
      navigator.clipboard.writeText(allTags).then(() => alert("ì „ì²´ ë³µì‚¬ ì™„ë£Œ!"));
    }
  </script>

  <!-- âœ… ì—ëŸ¬ì°½ í™•ì¸ ë²„íŠ¼ -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const errorBox = document.querySelector(".error");
      if (errorBox) {
        const btnContainer = document.createElement("div");
        btnContainer.className = "error-buttons";

        const dismissBtn = document.createElement("button")
        dismissBtn.textContent = "í™•ì¸";
        dismissBtn.className = "error-dismiss";
        dismissBtn.onclick = () => errorBox.style.display = "none";
        btnContainer.appendChild(dismissBtn);

        errorBox.appendChild(btnContainer);
      }
    });
  </script>

  <!-- âœ… AndroidAdì—ì„œë§Œ ë²„íŠ¼ ë³´ì´ê²Œ -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      if (typeof AndroidAd !== "undefined" && AndroidAd.showRewardAd) {
        const btn = document.createElement("button");
        btn.id = "reward-ad-button";
        btn.innerText = "ê´‘ê³ ë³´ê³  ë‹¤ì‹œ ìƒì„±í•˜ê¸°";
        btn.onclick = () => {
          console.log("ğŸ“¡ AndroidAd.showRewardAd í˜¸ì¶œ ì‹œë„");
          AndroidAd.showRewardAd();
        };
        document.getElementById("reward-container").appendChild(btn);
      }
    });
  </script>
</body>
</html>
